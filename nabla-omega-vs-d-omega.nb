(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     46744,       1269]
NotebookOptionsPosition[     43100,       1203]
NotebookOutlinePosition[     43513,       1220]
CellTagsIndexPosition[     43470,       1217]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ass", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Element]", "Reals"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Element]", "Reals"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.947213892039837*^9, 3.947213955987458*^9}, {
  3.947214900328936*^9, 3.947214927137545*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"941e5aab-3fd3-4695-b405-319bf2df25ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "[", "1", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "[", "2", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9472135989242687`*^9, 3.947213606841593*^9}, {
  3.947214702856924*^9, 3.947214703242113*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"9d958d08-e97e-43a2-b866-582670d08947"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "1", "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "1", "]"}], "[", "x", "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "2", "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "2", "]"}], "[", "x", "]"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.947214736927018*^9, 3.947214761200739*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"07f36995-79c8-47ae-ae53-b4df8e54b2c3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", 
  RowBox[{"Cross", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", "1", "]"}], "[", "x", "]"}], ",", 
    RowBox[{
     RowBox[{"e", "[", "2", "]"}], "[", "x", "]"}]}], "]"}], "]"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"b85432b2-8e23-4070-945c-b0ace37980c6"],

Cell[BoxData[
 SqrtBox[
  RowBox[{"1", "+", 
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"\[Omega]", "[", "1", "]"}], "[", "x", "]"}], "]"}], "2"], "+", 
   
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"\[Omega]", "[", "2", "]"}], "[", "x", "]"}], "]"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.9472164048923817`*^9, 3.9472168776031523`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"5896575b-fa7a-4e31-8e71-b893b341a6e0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cross", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], "[", "x", "]"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "2", "]"}], "[", "x", "]"}]}], "]"}], "/", 
   RowBox[{"Norm", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], "[", "x", "]"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.947214849326235*^9, 3.947214869634385*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"da79b1bf-c116-43b3-bd94-3de8ccb3f1f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "x_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], "[", "x", "]"}], ".", 
       RowBox[{
        RowBox[{"e", "[", "j", "]"}], "[", "x", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9472131179963617`*^9, 3.947213239105205*^9}, {
  3.9472144424738894`*^9, 3.94721444486241*^9}, {3.947214782060975*^9, 
  3.947214806962758*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"ae015ed9-feca-4df4-965f-2986215631c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gc", "[", "x_", "]"}], ":=", 
  RowBox[{"Inverse", "[", 
   RowBox[{"g", "[", "x", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9472151979228573`*^9, 3.947215232383896*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"3d6a3a30-de97-4538-9e13-e1546bc6c6df"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.947214808805229*^9, 3.9472148130249434`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"ce1bf29f-81df-488e-90db-149811eda752"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.947214813442338*^9, 3.9472149354780684`*^9, 
  3.947216877627481*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"d75ba529-e406-4694-ae85-c1c5ad2284b2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<ChristoffelSymbol\>\"", "]"}], "[", 
    
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], " ", "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.94721332793797*^9, 3.94721344827668*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"f6dcbf09-8372-4663-8147-872cf85b200f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]", "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "-", 
  RowBox[{
   RowBox[{"\[CapitalGamma]", "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947213436042321*^9, 3.947213441389639*^9}, {
  3.947213507010661*^9, 3.947213514900755*^9}, {3.947214458000112*^9, 
  3.947214463617508*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"cd8f2e45-ecc6-4c5e-9e03-3a69fd61064d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.947213442059997*^9, 3.947213449660377*^9}, {
   3.9472135090734987`*^9, 3.947213515342112*^9}, {3.947214455178977*^9, 
   3.9472144638732224`*^9}, 3.947214730581455*^9, 3.947214819225173*^9, 
   3.947214935499711*^9, 3.947216877940434*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"9daa960b-1d8e-4229-9893-291ca52462f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Derivative", "[", 
    RowBox[{"\[Epsilon]", "[", "2", "]"}], "]"}], "[", 
   RowBox[{"\[Omega]", "[", "1", "]"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.947213609855083*^9, 3.947213621595954*^9}, 
   3.947214706190493*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"c1cbcdc8-decf-4448-ba8e-ee438d34bb14"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"\[Omega]", "[", "1", "]"}], 
   TagBox[
    RowBox[{"(", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ")"}],
    Derivative],
   MultilineFunction->None], "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.9472136181672487`*^9, 3.947213621927956*^9}, 
   3.947214469635085*^9, 3.9472147305943613`*^9, 3.9472148195661373`*^9, 
   3.9472149355170593`*^9, 3.9472168779557858`*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"db3c051e-fe14-4f07-bc23-a497fcbdee86"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"this", " ", 
   RowBox[{"is", " ", "\\", "Nabla_k"}], " ", "omega_i"}], "*)"}]], "Input",
 CellChangeTimes->{{3.94721364380153*^9, 3.9472136515287247`*^9}, {
  3.947213709002059*^9, 3.9472137099992027`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"5d301a6e-215d-4704-abb6-028dddc47282"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nabla\[Omega]", "[", 
    RowBox[{"i_", ",", "k_"}], "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"\[Epsilon]", "[", "k", "]"}], "]"}], "[", 
     RowBox[{"\[Omega]", "[", "i", "]"}], "]"}], "[", "x", "]"}], "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "j", "]"}], "[", "x", "]"}], " ", 
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", "x", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i", ",", "k"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.947213582182987*^9, 3.947213593170781*^9}, {
   3.947213659065833*^9, 3.947213665678063*^9}, {3.947213697013775*^9, 
   3.9472137611460238`*^9}, {3.9472138571826277`*^9, 3.947213857381641*^9}, 
   3.9472147086024218`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"898ac9f2-dbe5-4313-a167-ebbd2d59727f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nablag", "[", 
    RowBox[{"i_", ",", "k_", ",", "l_"}], "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"\[Epsilon]", "[", "l", "]"}], "]"}], "[", "g", "]"}], "[", 
      "x", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"i", ",", "k"}], "]"}], "]"}], "-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", "x", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "k"}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"\[CapitalGamma]", "[", "x", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "i", ",", "l"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", "x", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"\[CapitalGamma]", "[", "x", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "k", ",", "l"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.9472165719156847`*^9, 3.947216701448023*^9}, {
  3.947216742523602*^9, 3.9472167427896547`*^9}, {3.947216791927813*^9, 
  3.947216797026524*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c97b6faa-4029-4aa4-8745-ef5337a03528"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Nablag", "[", 
     RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9472166343227453`*^9, 3.947216639007186*^9}, {
  3.9472166975988703`*^9, 3.947216704993441*^9}, {3.947216834685898*^9, 
  3.947216846651737*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0ed846a6-9483-4b24-a571-c64be06c735e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.947216639490131*^9, 3.947216705343843*^9}, 
   3.947216744106537*^9, 3.947216798073319*^9, 3.947216847101982*^9, 
   3.947216878004775*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"b5180252-ed33-42af-b364-8e5c18ec25be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]\[Omega]", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "==", 
       RowBox[{
        RowBox[{"Nabla\[Omega]", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.947214031368198*^9, 3.947214132524768*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"471eab95-79e2-4551-92e9-9a705867000f"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{
           RowBox[{
             RowBox[{"\[CapitalDelta]\[Omega]", "[", 
               RowBox[{"1", ",", "1"}], "]"}], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{
              RowBox[{
                SuperscriptBox[
                 RowBox[{"\[Omega]", "[", "1", "]"}], 
                 TagBox[
                  RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                 MultilineFunction -> None], "[", 
                RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}], "]"}], "+", 
              RowBox[{
                RowBox[{
                  RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
                RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
                RowBox[{"(", 
                  RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Omega]", "[", "1", "]"}], 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                    MultilineFunction -> None], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "-", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Omega]", "[", "2", "]"}], 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                    MultilineFunction -> None], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}]}]}], 
            RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}], ",", 
         RowBox[{
           RowBox[{
             RowBox[{"\[CapitalDelta]\[Omega]", "[", 
               RowBox[{"1", ",", "2"}], "]"}], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{
              RowBox[{
                RowBox[{"(", 
                  RowBox[{"1", "+", 
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}], " ", 
                RowBox[{
                  SuperscriptBox[
                   RowBox[{"\[Omega]", "[", "1", "]"}], 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                   MultilineFunction -> None], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "-", 
              RowBox[{
                SuperscriptBox[
                 RowBox[{
                   RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], " ", 
                RowBox[{
                  SuperscriptBox[
                   RowBox[{"\[Omega]", "[", "2", "]"}], 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                   MultilineFunction -> None], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}]}], 
            RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}], ",", 
         RowBox[{
           RowBox[{
             RowBox[{"\[CapitalDelta]\[Omega]", "[", 
               RowBox[{"2", ",", "1"}], "]"}], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{
              RowBox[{
                RowBox[{"-", 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], " ", 
                RowBox[{
                  SuperscriptBox[
                   RowBox[{"\[Omega]", "[", "1", "]"}], 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                   MultilineFunction -> None], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
              RowBox[{
                RowBox[{"(", 
                  RowBox[{"1", "+", 
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}], " ", 
                RowBox[{
                  SuperscriptBox[
                   RowBox[{"\[Omega]", "[", "2", "]"}], 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                   MultilineFunction -> None], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}]}], 
            RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}], ",", 
         RowBox[{
           RowBox[{
             RowBox[{"\[CapitalDelta]\[Omega]", "[", 
               RowBox[{"2", ",", "2"}], "]"}], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{
              RowBox[{
                SuperscriptBox[
                 RowBox[{"\[Omega]", "[", "2", "]"}], 
                 TagBox[
                  RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                 MultilineFunction -> None], "[", 
                RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}], "]"}], "+", 
              RowBox[{
                RowBox[{
                  RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
                RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
                RowBox[{"(", 
                  RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Omega]", "[", "1", "]"}], 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                    MultilineFunction -> None], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Omega]", "[", "2", "]"}], 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                    MultilineFunction -> None], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}]}]}], 
            RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}]}], "}"}], 
     Short[#, 8]& ], "line" -> 18, "sessionID" -> 22241054323331168183, 
   "byteCount" -> 9992, "size" -> 8, "stored" -> False, "expr" -> 
   Missing["NotStored"], "wrap" -> OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{{3.947214088603829*^9, 3.947214133460835*^9}, 
   3.947214610889537*^9, 3.947214730754723*^9, 3.9472148209028263`*^9, 
   3.947214935542285*^9, 3.9472168781624317`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"772abd27-8e21-4759-8f07-336c72423da4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unknowns", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"\[Epsilon]", "[", "i", "]"}], "]"}], "[", 
       RowBox[{"\[Omega]", "[", "j", "]"}], "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947214197112801*^9, 3.947214214227942*^9}, 
   3.947214713502252*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"8f07b349-dac1-4434-a4d1-063fd38ead63"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Omega]", "[", "1", "]"}], 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Omega]", "[", "2", "]"}], 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Omega]", "[", "1", "]"}], 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Omega]", "[", "2", "]"}], 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9472141848072433`*^9, 3.94721421483416*^9}, 
   3.947214614956092*^9, 3.9472147308334846`*^9, 3.947214821915153*^9, 
   3.947214935564352*^9, 3.947216878242217*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"45d766f4-fea6-4e74-9e33-94e0ed24e17b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{"eqs", ",", "unknowns"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947214136659564*^9, 3.94721417207031*^9}, {
  3.947214202665114*^9, 3.947214222792139*^9}, {3.947214343511335*^9, 
  3.9472143516553917`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"c0c2d921-b306-457e-a3db-5781de68977a"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{
           RowBox[{
             SuperscriptBox[
              RowBox[{"\[Omega]", "[", "1", "]"}], 
              TagBox[
               RowBox[{"(", 
                 RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
              MultilineFunction -> None], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Rule]", 
           RowBox[{
             RowBox[{
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                    RowBox[{"1", ",", "2"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], " ", 
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"1", ",", "1"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], 
                 ")"}]}]}]}], ",", 
         RowBox[{
           RowBox[{
             SuperscriptBox[
              RowBox[{"\[Omega]", "[", "2", "]"}], 
              TagBox[
               RowBox[{"(", 
                 RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
              MultilineFunction -> None], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Rule]", 
           RowBox[{
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"1", ",", "2"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{
                  RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], "+", 
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"2", ",", "1"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], 
                 ")"}]}]}]}], ",", 
         RowBox[{
           RowBox[{
             SuperscriptBox[
              RowBox[{"\[Omega]", "[", "1", "]"}], 
              TagBox[
               RowBox[{"(", 
                 RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
              MultilineFunction -> None], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Rule]", 
           RowBox[{
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"1", ",", "2"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}]}], 
             "+", 
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"2", ",", "1"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]}]}], ",", 
         RowBox[{
           RowBox[{
             SuperscriptBox[
              RowBox[{"\[Omega]", "[", "2", "]"}], 
              TagBox[
               RowBox[{"(", 
                 RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
              MultilineFunction -> None], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Rule]", 
           RowBox[{
             RowBox[{
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                    RowBox[{"1", ",", "2"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], " ", 
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"2", ",", "2"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], 
                 ")"}]}]}]}]}], "}"}], Short[#, 8]& ], "line" -> 20, 
   "sessionID" -> 22241054323331168183, "byteCount" -> 7464, "size" -> 8, 
   "stored" -> False, "expr" -> Missing["NotStored"], "wrap" -> 
   OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{{3.947214206535041*^9, 3.947214223157372*^9}, 
   3.947214352039406*^9, 3.947214615635469*^9, 3.947214730860752*^9, 
   3.947214822346347*^9, 3.947214935569178*^9, 3.947216878263623*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"396a1667-d128-435f-b9f7-6dd0b4c71d21"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", "[", "x_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"\[Epsilon]", "[", "j", "]"}], "]"}], "[", "n", "]"}], 
           "[", "x", "]"}], ".", 
          RowBox[{
           RowBox[{"e", "[", "i", "]"}], "[", "x", "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Assumptions", "->", "ass"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947214954061626*^9, 3.947214983020706*^9}, {
  3.947215023040928*^9, 3.947215101622671*^9}, {3.947215146879895*^9, 
  3.947215149925465*^9}, {3.94721625423308*^9, 3.9472162838886347`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"b44ab076-f822-4ef2-84e7-109e1391f9d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"H", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", "2"}], 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"gc", "[", "x", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"b", "[", "x", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "i"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"Assumptions", "->", "ass"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.947215161150049*^9, 3.947215163557864*^9}, {
  3.947215243594561*^9, 3.947215310121801*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"cab8e58b-bec7-45af-8037-3a461d12bd7a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"H", "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}], "/.", "sol"}], ",", 
   RowBox[{"Assumptions", "->", "ass"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.947215299586842*^9, 3.947215333447728*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"73e10981-6e54-4ad2-8940-664ad203ac01"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Omega]", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalDelta]\[Omega]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "+", 
      RowBox[{
       RowBox[{"\[CapitalDelta]\[Omega]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], " ", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Omega]", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   SqrtBox[
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.947215314207008*^9, 3.947215333878953*^9}, {
   3.947216263255115*^9, 3.9472162857495327`*^9}, 3.94721687836198*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"5de1eef3-df50-4644-ba71-165632e96e8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "2"}], 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"gc", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], 
       RowBox[{
        RowBox[{"\[CapitalDelta]\[Omega]", "[", 
         RowBox[{"j", ",", "i"}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Assumptions", "->", "ass"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947215402235783*^9, 3.9472154700799627`*^9}, {
  3.947215646351952*^9, 3.947215665466732*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"57e41ff7-36ca-48c9-b906-1389e3cef2ed"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Omega]", "[", 
      RowBox[{"2", ",", "2"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalDelta]\[Omega]", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "+", 
      RowBox[{
       RowBox[{"\[CapitalDelta]\[Omega]", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], " ", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Omega]", "[", 
      RowBox[{"1", ",", "1"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.947215404440551*^9, {3.947215438071714*^9, 3.947215470438365*^9}, {
   3.947215650652382*^9, 3.9472156659165916`*^9}, 3.947216289162298*^9, 
   3.947216878429097*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"fb4ba288-c1f0-417c-a90f-25e939dc9fa2"]
}, Open  ]]
},
WindowSize->{1512, 863},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fd6910bf-b8e4-47e8-800f-256ce557410e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 652, 18, 36, "Input",ExpressionUUID->"941e5aab-3fd3-4695-b405-319bf2df25ee"],
Cell[1209, 40, 506, 13, 62, "Input",ExpressionUUID->"9d958d08-e97e-43a2-b866-582670d08947"],
Cell[1718, 55, 621, 18, 62, "Input",ExpressionUUID->"07f36995-79c8-47ae-ae53-b4df8e54b2c3"],
Cell[CellGroupData[{
Cell[2364, 77, 313, 8, 36, "Input",ExpressionUUID->"b85432b2-8e23-4070-945c-b0ace37980c6"],
Cell[2680, 87, 481, 14, 43, "Output",ExpressionUUID->"5896575b-fa7a-4e31-8e71-b893b341a6e0"]
}, Open  ]],
Cell[3176, 104, 657, 19, 36, "Input",ExpressionUUID->"da79b1bf-c116-43b3-bd94-3de8ccb3f1f8"],
Cell[3836, 125, 727, 19, 36, "Input",ExpressionUUID->"ae015ed9-feca-4df4-965f-2986215631c9"],
Cell[4566, 146, 289, 6, 36, "Input",ExpressionUUID->"3d6a3a30-de97-4538-9e13-e1546bc6c6df"],
Cell[CellGroupData[{
Cell[4880, 156, 248, 5, 36, "Input",ExpressionUUID->"ce1bf29f-81df-488e-90db-149811eda752"],
Cell[5131, 163, 1286, 40, 44, "Output",ExpressionUUID->"d75ba529-e406-4694-ae85-c1c5ad2284b2"]
}, Open  ]],
Cell[6432, 206, 804, 23, 36, "Input",ExpressionUUID->"f6dcbf09-8372-4663-8147-872cf85b200f"],
Cell[CellGroupData[{
Cell[7261, 233, 654, 17, 36, "Input",ExpressionUUID->"cd8f2e45-ecc6-4c5e-9e03-3a69fd61064d"],
Cell[7918, 252, 369, 5, 41, "Output",ExpressionUUID->"9daa960b-1d8e-4229-9893-291ca52462f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8324, 262, 413, 10, 36, "Input",ExpressionUUID->"c1cbcdc8-decf-4448-ba8e-ee438d34bb14"],
Cell[8740, 274, 569, 15, 41, "Output",ExpressionUUID->"db3c051e-fe14-4f07-bc23-a497fcbdee86"]
}, Open  ]],
Cell[9324, 292, 327, 6, 36, "Input",ExpressionUUID->"5d301a6e-215d-4704-abb6-028dddc47282"],
Cell[9654, 300, 1034, 26, 36, "Input",ExpressionUUID->"898ac9f2-dbe5-4313-a167-ebbd2d59727f"],
Cell[10691, 328, 1563, 45, 62, "Input",ExpressionUUID->"c97b6faa-4029-4aa4-8745-ef5337a03528"],
Cell[CellGroupData[{
Cell[12279, 377, 676, 17, 36, "Input",ExpressionUUID->"0ed846a6-9483-4b24-a571-c64be06c735e"],
Cell[12958, 396, 624, 18, 41, "Output",ExpressionUUID->"b5180252-ed33-42af-b364-8e5c18ec25be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13619, 419, 844, 23, 36, "Input",ExpressionUUID->"471eab95-79e2-4551-92e9-9a705867000f"],
Cell[14466, 444, 10113, 239, 153, "Output",ExpressionUUID->"772abd27-8e21-4759-8f07-336c72423da4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24616, 688, 698, 18, 36, "Input",ExpressionUUID->"8f07b349-dac1-4434-a4d1-063fd38ead63"],
Cell[25317, 708, 1519, 50, 44, "Output",ExpressionUUID->"45d766f4-fea6-4e74-9e33-94e0ed24e17b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26873, 763, 438, 9, 36, "Input",ExpressionUUID->"c0c2d921-b306-457e-a3db-5781de68977a"],
Cell[27314, 774, 8043, 190, 139, "Output",ExpressionUUID->"396a1667-d128-435f-b9f7-6dd0b4c71d21"]
}, Open  ]],
Cell[35372, 967, 1035, 26, 36, "Input",ExpressionUUID->"b44ab076-f822-4ef2-84e7-109e1391f9d7"],
Cell[36410, 995, 907, 25, 36, "Input",ExpressionUUID->"cab8e58b-bec7-45af-8037-3a461d12bd7a"],
Cell[CellGroupData[{
Cell[37342, 1024, 380, 9, 36, "Input",ExpressionUUID->"73e10981-6e54-4ad2-8940-664ad203ac01"],
Cell[37725, 1035, 2153, 65, 69, "Output",ExpressionUUID->"5de1eef3-df50-4644-ba71-165632e96e8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39915, 1105, 950, 26, 36, "Input",ExpressionUUID->"57e41ff7-36ca-48c9-b906-1389e3cef2ed"],
Cell[40868, 1133, 2216, 67, 85, "Output",ExpressionUUID->"fb4ba288-c1f0-417c-a90f-25e939dc9fa2"]
}, Open  ]]
}
]
*)

