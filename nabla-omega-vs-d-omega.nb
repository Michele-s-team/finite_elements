(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     34616,        913]
NotebookOptionsPosition[     32156,        866]
NotebookOutlinePosition[     32569,        883]
CellTagsIndexPosition[     32526,        880]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"ass", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Element]", "Reals"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Element]", "Reals"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.947213892039837*^9, 3.947213955987458*^9}, {
  3.947214900328936*^9, 3.947214927137545*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"941e5aab-3fd3-4695-b405-319bf2df25ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "[", "1", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "[", "2", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9472135989242687`*^9, 3.947213606841593*^9}, {
  3.947214702856924*^9, 3.947214703242113*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"9d958d08-e97e-43a2-b866-582670d08947"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "1", "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "1", "]"}], "[", "x", "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "2", "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1", ",", 
    RowBox[{
     RowBox[{"\[Omega]", "[", "2", "]"}], "[", "x", "]"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.947214736927018*^9, 3.947214761200739*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"07f36995-79c8-47ae-ae53-b4df8e54b2c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cross", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", "1", "]"}], "[", "x", "]"}], ",", 
     RowBox[{
      RowBox[{"e", "[", "2", "]"}], "[", "x", "]"}]}], "]"}], "/", 
   RowBox[{"Norm", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", "1", "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"e", "[", "2", "]"}], "[", "x", "]"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.947214849326235*^9, 3.947214869634385*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"da79b1bf-c116-43b3-bd94-3de8ccb3f1f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "x_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", "i", "]"}], "[", "x", "]"}], ".", 
       RowBox[{
        RowBox[{"e", "[", "j", "]"}], "[", "x", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9472131179963617`*^9, 3.947213239105205*^9}, {
  3.9472144424738894`*^9, 3.94721444486241*^9}, {3.947214782060975*^9, 
  3.947214806962758*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"ae015ed9-feca-4df4-965f-2986215631c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.947214808805229*^9, 3.9472148130249434`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"ce1bf29f-81df-488e-90db-149811eda752"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
      RowBox[{
       RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
     RowBox[{"1", "+", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.947214813442338*^9, 3.9472149354780684`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"b99ebd25-2189-4b56-a248-cab3af559a29"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalGamma]", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<ChristoffelSymbol\>\"", "]"}], "[", 
    
    RowBox[{
     RowBox[{"g", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], " ", "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.94721332793797*^9, 3.94721344827668*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"f6dcbf09-8372-4663-8147-872cf85b200f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]", "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "-", 
  RowBox[{
   RowBox[{"\[CapitalGamma]", "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947213436042321*^9, 3.947213441389639*^9}, {
  3.947213507010661*^9, 3.947213514900755*^9}, {3.947214458000112*^9, 
  3.947214463617508*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"cd8f2e45-ecc6-4c5e-9e03-3a69fd61064d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.947213442059997*^9, 3.947213449660377*^9}, {
   3.9472135090734987`*^9, 3.947213515342112*^9}, {3.947214455178977*^9, 
   3.9472144638732224`*^9}, 3.947214730581455*^9, 3.947214819225173*^9, 
   3.947214935499711*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"0267848e-c982-4620-aa8f-31d2ce92ef84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Derivative", "[", 
    RowBox[{"\[Epsilon]", "[", "2", "]"}], "]"}], "[", 
   RowBox[{"\[Omega]", "[", "1", "]"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.947213609855083*^9, 3.947213621595954*^9}, 
   3.947214706190493*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"c1cbcdc8-decf-4448-ba8e-ee438d34bb14"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"\[Omega]", "[", "1", "]"}], 
   TagBox[
    RowBox[{"(", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ")"}],
    Derivative],
   MultilineFunction->None], "[", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.9472136181672487`*^9, 3.947213621927956*^9}, 
   3.947214469635085*^9, 3.9472147305943613`*^9, 3.9472148195661373`*^9, 
   3.9472149355170593`*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"933e1d96-272c-48e5-82d3-e667e28dbe89"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"this", " ", 
   RowBox[{"is", " ", "\\", "Nabla_k"}], " ", "omega_i"}], "*)"}]], "Input",
 CellChangeTimes->{{3.94721364380153*^9, 3.9472136515287247`*^9}, {
  3.947213709002059*^9, 3.9472137099992027`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"5d301a6e-215d-4704-abb6-028dddc47282"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nabla\[Omega]", "[", 
    RowBox[{"i_", ",", "k_"}], "]"}], "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", 
      RowBox[{"\[Epsilon]", "[", "k", "]"}], "]"}], "[", 
     RowBox[{"\[Omega]", "[", "i", "]"}], "]"}], "[", "x", "]"}], "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "[", "j", "]"}], "[", "x", "]"}], " ", 
      RowBox[{
       RowBox[{"\[CapitalGamma]", "[", "x", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "i", ",", "k"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.947213582182987*^9, 3.947213593170781*^9}, {
   3.947213659065833*^9, 3.947213665678063*^9}, {3.947213697013775*^9, 
   3.9472137611460238`*^9}, {3.9472138571826277`*^9, 3.947213857381641*^9}, 
   3.9472147086024218`*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"898ac9f2-dbe5-4313-a167-ebbd2d59727f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]\[Omega]", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], "==", 
       RowBox[{
        RowBox[{"Nabla\[Omega]", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.947214031368198*^9, 3.947214132524768*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"471eab95-79e2-4551-92e9-9a705867000f"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{
           RowBox[{
             RowBox[{"\[CapitalDelta]\[Omega]", "[", 
               RowBox[{"1", ",", "1"}], "]"}], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{
              RowBox[{
                SuperscriptBox[
                 RowBox[{"\[Omega]", "[", "1", "]"}], 
                 TagBox[
                  RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                 MultilineFunction -> None], "[", 
                RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}], "]"}], "+", 
              RowBox[{
                RowBox[{
                  RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
                RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
                RowBox[{"(", 
                  RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Omega]", "[", "1", "]"}], 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                    MultilineFunction -> None], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "-", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Omega]", "[", "2", "]"}], 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                    MultilineFunction -> None], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}]}]}], 
            RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}], ",", 
         RowBox[{
           RowBox[{
             RowBox[{"\[CapitalDelta]\[Omega]", "[", 
               RowBox[{"1", ",", "2"}], "]"}], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{
              RowBox[{
                RowBox[{"(", 
                  RowBox[{"1", "+", 
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}], " ", 
                RowBox[{
                  SuperscriptBox[
                   RowBox[{"\[Omega]", "[", "1", "]"}], 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                   MultilineFunction -> None], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "-", 
              RowBox[{
                SuperscriptBox[
                 RowBox[{
                   RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], " ", 
                RowBox[{
                  SuperscriptBox[
                   RowBox[{"\[Omega]", "[", "2", "]"}], 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                   MultilineFunction -> None], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}]}], 
            RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}], ",", 
         RowBox[{
           RowBox[{
             RowBox[{"\[CapitalDelta]\[Omega]", "[", 
               RowBox[{"2", ",", "1"}], "]"}], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{
              RowBox[{
                RowBox[{"-", 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], " ", 
                RowBox[{
                  SuperscriptBox[
                   RowBox[{"\[Omega]", "[", "1", "]"}], 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                   MultilineFunction -> None], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
              RowBox[{
                RowBox[{"(", 
                  RowBox[{"1", "+", 
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}], " ", 
                RowBox[{
                  SuperscriptBox[
                   RowBox[{"\[Omega]", "[", "2", "]"}], 
                   TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                   MultilineFunction -> None], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}]}], 
            RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}], ",", 
         RowBox[{
           RowBox[{
             RowBox[{"\[CapitalDelta]\[Omega]", "[", 
               RowBox[{"2", ",", "2"}], "]"}], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Equal]", 
           FractionBox[
            RowBox[{
              RowBox[{
                SuperscriptBox[
                 RowBox[{"\[Omega]", "[", "2", "]"}], 
                 TagBox[
                  RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                 MultilineFunction -> None], "[", 
                RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}], "]"}], "+", 
              RowBox[{
                RowBox[{
                  RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
                RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
                RowBox[{"(", 
                  RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Omega]", "[", "1", "]"}], 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
                    MultilineFunction -> None], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Omega]", "[", "2", "]"}], 
                    TagBox[
                    RowBox[{"(", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
                    MultilineFunction -> None], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}]}]}], 
            RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]]}]}], "}"}], 
     Short[#, 8]& ], "line" -> 48, "sessionID" -> 22241040225305570084, 
   "byteCount" -> 9992, "size" -> 8, "stored" -> False, "expr" -> 
   Missing["NotStored"], "wrap" -> OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{{3.947214088603829*^9, 3.947214133460835*^9}, 
   3.947214610889537*^9, 3.947214730754723*^9, 3.9472148209028263`*^9, 
   3.947214935542285*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"1733d3d8-d3e0-4450-a09b-8af65679ee24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unknowns", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", 
        RowBox[{"\[Epsilon]", "[", "i", "]"}], "]"}], "[", 
       RowBox[{"\[Omega]", "[", "j", "]"}], "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947214197112801*^9, 3.947214214227942*^9}, 
   3.947214713502252*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"8f07b349-dac1-4434-a4d1-063fd38ead63"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Omega]", "[", "1", "]"}], 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Omega]", "[", "2", "]"}], 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Omega]", "[", "1", "]"}], 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Omega]", "[", "2", "]"}], 
     TagBox[
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9472141848072433`*^9, 3.94721421483416*^9}, 
   3.947214614956092*^9, 3.9472147308334846`*^9, 3.947214821915153*^9, 
   3.947214935564352*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"4d16137e-133a-4e60-9ea7-1e875ad6068d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{"eqs", ",", "unknowns"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947214136659564*^9, 3.94721417207031*^9}, {
  3.947214202665114*^9, 3.947214222792139*^9}, {3.947214343511335*^9, 
  3.9472143516553917`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"c0c2d921-b306-457e-a3db-5781de68977a"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{"{", 
       RowBox[{
         RowBox[{
           RowBox[{
             SuperscriptBox[
              RowBox[{"\[Omega]", "[", "1", "]"}], 
              TagBox[
               RowBox[{"(", 
                 RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
              MultilineFunction -> None], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Rule]", 
           RowBox[{
             RowBox[{
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    RowBox[{
                    RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                    RowBox[{"1", ",", "2"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], " ", 
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"1", ",", "1"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], 
                 ")"}]}]}]}], ",", 
         RowBox[{
           RowBox[{
             SuperscriptBox[
              RowBox[{"\[Omega]", "[", "2", "]"}], 
              TagBox[
               RowBox[{"(", 
                 RowBox[{"{", 
                   RowBox[{"1", ",", "0"}], "}"}], ")"}], Derivative], 
              MultilineFunction -> None], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Rule]", 
           RowBox[{
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"1", ",", "2"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{
                  RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], "+", 
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"2", ",", "1"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], 
                 ")"}]}]}]}], ",", 
         RowBox[{
           RowBox[{
             SuperscriptBox[
              RowBox[{"\[Omega]", "[", "1", "]"}], 
              TagBox[
               RowBox[{"(", 
                 RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
              MultilineFunction -> None], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Rule]", 
           RowBox[{
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"1", ",", "2"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], ")"}]}], 
             "+", 
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"2", ",", "1"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               SuperscriptBox[
                RowBox[{
                  RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                  RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}]}]}], ",", 
         RowBox[{
           RowBox[{
             SuperscriptBox[
              RowBox[{"\[Omega]", "[", "2", "]"}], 
              TagBox[
               RowBox[{"(", 
                 RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ")"}], Derivative], 
              MultilineFunction -> None], "[", 
             RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "]"}], "\[Rule]", 
           RowBox[{
             RowBox[{
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                    RowBox[{"1", ",", "2"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], " ", 
               RowBox[{
                 RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{
                 RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "+", 
             RowBox[{
               RowBox[{
                 RowBox[{"\[CapitalDelta]\[Omega]", "[", 
                   RowBox[{"2", ",", "2"}], "]"}], "[", 
                 RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{"1", "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "1", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"], "+", 
                   SuperscriptBox[
                    RowBox[{
                    RowBox[{"\[Omega]", "[", "2", "]"}], "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}], "]"}], "2"]}], 
                 ")"}]}]}]}]}], "}"}], Short[#, 8]& ], "line" -> 50, 
   "sessionID" -> 22241040225305570084, "byteCount" -> 7464, "size" -> 8, 
   "stored" -> False, "expr" -> Missing["NotStored"], "wrap" -> 
   OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{{3.947214206535041*^9, 3.947214223157372*^9}, 
   3.947214352039406*^9, 3.947214615635469*^9, 3.947214730860752*^9, 
   3.947214822346347*^9, 3.947214935569178*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"17c8ffe6-941b-4203-a741-ae088907be2f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", "[", "x_", "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"\[Epsilon]", "[", "j", "]"}], "]"}], "[", 
           RowBox[{"e", "[", "i", "]"}], "]"}], "[", "x", "]"}], ".", 
         RowBox[{"n", "[", "x", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Assumptions", "->", "ass"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.947214954061626*^9, 3.947214983020706*^9}, {
  3.947215023040928*^9, 3.947215101622671*^9}, {3.947215146879895*^9, 
  3.947215149925465*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"b44ab076-f822-4ef2-84e7-109e1391f9d7"]
},
WindowSize->{1512, 863},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"14.1 for Mac OS X ARM (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fd6910bf-b8e4-47e8-800f-256ce557410e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 653, 18, 36, "Input",ExpressionUUID->"941e5aab-3fd3-4695-b405-319bf2df25ee"],
Cell[1210, 40, 507, 13, 62, "Input",ExpressionUUID->"9d958d08-e97e-43a2-b866-582670d08947"],
Cell[1720, 55, 622, 18, 62, "Input",ExpressionUUID->"07f36995-79c8-47ae-ae53-b4df8e54b2c3"],
Cell[2345, 75, 658, 19, 36, "Input",ExpressionUUID->"da79b1bf-c116-43b3-bd94-3de8ccb3f1f8"],
Cell[3006, 96, 728, 19, 36, "Input",ExpressionUUID->"ae015ed9-feca-4df4-965f-2986215631c9"],
Cell[CellGroupData[{
Cell[3759, 119, 248, 5, 36, "Input",ExpressionUUID->"ce1bf29f-81df-488e-90db-149811eda752"],
Cell[4010, 126, 1261, 39, 44, "Output",ExpressionUUID->"b99ebd25-2189-4b56-a248-cab3af559a29"]
}, Open  ]],
Cell[5286, 168, 804, 23, 36, "Input",ExpressionUUID->"f6dcbf09-8372-4663-8147-872cf85b200f"],
Cell[CellGroupData[{
Cell[6115, 195, 654, 17, 36, "Input",ExpressionUUID->"cd8f2e45-ecc6-4c5e-9e03-3a69fd61064d"],
Cell[6772, 214, 347, 5, 41, "Output",ExpressionUUID->"0267848e-c982-4620-aa8f-31d2ce92ef84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7156, 224, 413, 10, 36, "Input",ExpressionUUID->"c1cbcdc8-decf-4448-ba8e-ee438d34bb14"],
Cell[7572, 236, 545, 15, 41, "Output",ExpressionUUID->"933e1d96-272c-48e5-82d3-e667e28dbe89"]
}, Open  ]],
Cell[8132, 254, 327, 6, 36, "Input",ExpressionUUID->"5d301a6e-215d-4704-abb6-028dddc47282"],
Cell[8462, 262, 1034, 26, 36, "Input",ExpressionUUID->"898ac9f2-dbe5-4313-a167-ebbd2d59727f"],
Cell[CellGroupData[{
Cell[9521, 292, 844, 23, 36, "Input",ExpressionUUID->"471eab95-79e2-4551-92e9-9a705867000f"],
Cell[10368, 317, 10089, 239, 153, "Output",ExpressionUUID->"1733d3d8-d3e0-4450-a09b-8af65679ee24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20494, 561, 698, 18, 36, "Input",ExpressionUUID->"8f07b349-dac1-4434-a4d1-063fd38ead63"],
Cell[21195, 581, 1497, 50, 44, "Output",ExpressionUUID->"4d16137e-133a-4e60-9ea7-1e875ad6068d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22729, 636, 438, 9, 36, "Input",ExpressionUUID->"c0c2d921-b306-457e-a3db-5781de68977a"],
Cell[23170, 647, 8021, 190, 139, "Output",ExpressionUUID->"17c8ffe6-941b-4203-a741-ae088907be2f"]
}, Open  ]],
Cell[31206, 840, 946, 24, 36, "Input",ExpressionUUID->"b44ab076-f822-4ef2-84e7-109e1391f9d7"]
}
]
*)

